 SELECT 'Arrendamiento'::text AS tipo_contrato,
    ca.id_contrato_a AS id_contrato,
    ca.id_propiedad,
    p.direccion_propiedad AS direccion,
    per.nombre_completo AS inquilino_propietario,
    ca.fecha_fin_contrato_a AS fecha_fin,
    ((ca.fecha_fin_contrato_a)::date - CURRENT_DATE) AS dias_restantes
   FROM (((contratos_arrendamientos ca
     JOIN propiedades p ON ((ca.id_propiedad = p.id_propiedad)))
     JOIN arrendatarios arr ON ((ca.id_arrendatario = arr.id_arrendatario)))
     JOIN personas per ON ((arr.id_persona = per.id_persona)))
  WHERE ((ca.estado_contrato_a = 'Activo'::text) AND ((ca.fecha_fin_contrato_a)::date <= (CURRENT_DATE + '90 days'::interval)))
UNION ALL
 SELECT 'Mandato'::text AS tipo_contrato,
    cm.id_contrato_m AS id_contrato,
    cm.id_propiedad,
    p.direccion_propiedad AS direccion,
    per.nombre_completo AS inquilino_propietario,
    cm.fecha_fin_contrato_m AS fecha_fin,
    ((cm.fecha_fin_contrato_m)::date - CURRENT_DATE) AS dias_restantes
   FROM (((contratos_mandatos cm
     JOIN propiedades p ON ((cm.id_propiedad = p.id_propiedad)))
     JOIN propietarios prop ON ((cm.id_propietario = prop.id_propietario)))
     JOIN personas per ON ((prop.id_persona = per.id_persona)))
  WHERE ((cm.estado_contrato_m = 'Activo'::text) AND ((cm.fecha_fin_contrato_m)::date <= (CURRENT_DATE + '90 days'::interval)))
  ORDER BY 7;