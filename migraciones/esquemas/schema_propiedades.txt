CREATE TABLE PROPIEDADES (

    ID_PROPIEDAD INTEGER PRIMARY KEY AUTOINCREMENT,

    MATRICULA_INMOBILIARIA TEXT NOT NULL UNIQUE,

    ID_MUNICIPIO INTEGER NOT NULL,

    DIRECCION_PROPIEDAD TEXT NOT NULL,

    TIPO_PROPIEDAD TEXT NOT NULL,

    DISPONIBILIDAD_PROPIEDAD INTEGER DEFAULT 1 CHECK(DISPONIBILIDAD_PROPIEDAD IN (0, 1)),

    AREA_M2 REAL NOT NULL CHECK(AREA_M2 > 0),

    HABITACIONES INTEGER DEFAULT 0 CHECK(HABITACIONES >= 0),

    BANO INTEGER DEFAULT 0 CHECK(BANO >= 0),

    PARQUEADERO INTEGER DEFAULT 0 CHECK(PARQUEADERO >= 0),

    ESTRATO INTEGER CHECK(ESTRATO BETWEEN 1 AND 6),

    VALOR_ADMINISTRACION INTEGER DEFAULT 0 CHECK(VALOR_ADMINISTRACION >= 0),

    -- CORRECCI├ôN: Se agrega columna faltante para la vista de reportes

    CANON_ARRENDAMIENTO_ESTIMADO INTEGER DEFAULT 0 CHECK(CANON_ARRENDAMIENTO_ESTIMADO >= 0),

    VALOR_VENTA_PROPIEDAD INTEGER DEFAULT 0 CHECK(VALOR_VENTA_PROPIEDAD >= 0),

    COMISION_VENTA_PROPIEDAD INTEGER DEFAULT 0 CHECK(COMISION_VENTA_PROPIEDAD >= 0),

    OBSERVACIONES_PROPIEDAD TEXT,

    FECHA_INGRESO_PROPIEDAD TEXT DEFAULT (date('now')),

    ESTADO_REGISTRO INTEGER DEFAULT 1 CHECK(ESTADO_REGISTRO IN (0, 1)),

    MOTIVO_INACTIVACION TEXT,

    CREATED_AT TEXT DEFAULT (datetime('now', 'localtime')),

    CREATED_BY TEXT,

    UPDATED_AT TEXT DEFAULT (datetime('now', 'localtime')),

    UPDATED_BY TEXT,

    FOREIGN KEY (ID_MUNICIPIO) REFERENCES MUNICIPIOS(ID_MUNICIPIO)

);
CREATE INDEX idx_propiedades_disponibilidad ON PROPIEDADES(DISPONIBILIDAD_PROPIEDAD);
CREATE INDEX idx_propiedades_municipio ON PROPIEDADES(ID_MUNICIPIO, ESTADO_REGISTRO);
CREATE INDEX idx_propiedades_estado ON PROPIEDADES(ESTADO_REGISTRO);
